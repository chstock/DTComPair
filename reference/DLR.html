<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimating the Capacity for Improvement in Diagnostic Risk Prediction with an additional marker based on the Diagnostic Likelihood Ratio (DLR) — DLR • DTComPair</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the Capacity for Improvement in Diagnostic Risk Prediction with an additional marker based on the Diagnostic Likelihood Ratio (DLR) — DLR"><meta name="description" content="This function allows for estimating the log diagnostic likelihood ratio in a regression model approach.
It can be used to assess the gain in diagnostic accuracy for a new binary or continuous diagnostic marker compared
to established markers, to determine the impact of covariates on the risk prediction model, and to estimate the
DLR for selected marker/covariate values."><meta property="og:description" content="This function allows for estimating the log diagnostic likelihood ratio in a regression model approach.
It can be used to assess the gain in diagnostic accuracy for a new binary or continuous diagnostic marker compared
to established markers, to determine the impact of covariates on the risk prediction model, and to estimate the
DLR for selected marker/covariate values."><meta property="og:image" content="https://chstock.github.io/DTComPair/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DTComPair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chstock/DTComPair/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating the Capacity for Improvement in Diagnostic Risk Prediction with an additional marker based on the Diagnostic Likelihood Ratio (DLR)</h1>

      <div class="d-none name"><code>DLR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows for estimating the log diagnostic likelihood ratio in a regression model approach.
It can be used to assess the gain in diagnostic accuracy for a new binary or continuous diagnostic marker compared
to established markers, to determine the impact of covariates on the risk prediction model, and to estimate the
DLR for selected marker/covariate values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DLR</span><span class="op">(</span><span class="va">basemodel</span>, <span class="va">augmentedmodel</span>, <span class="va">diseasestatus</span>, <span class="va">dataset</span>, clustervar <span class="op">=</span> <span class="cn">NULL</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-basemodel">basemodel<a class="anchor" aria-label="anchor" href="#arg-basemodel"></a></dt>
<dd><p>pre-test/base model X, formula character string</p></dd>

  <dt id="arg-augmentedmodel">augmentedmodel<a class="anchor" aria-label="anchor" href="#arg-augmentedmodel"></a></dt>
<dd><p>post-test/ augmented model V, formula character string,
  this is usually the basemodel X including the additional diagnostic test of interest Y and interactions XY</p></dd>

  <dt id="arg-diseasestatus">diseasestatus<a class="anchor" aria-label="anchor" href="#arg-diseasestatus"></a></dt>
<dd><p>variable name containing disease status, assumed to be a 0/1 variable, for having condition of interest (1) or not (0), character string</p></dd>

  <dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>dataframe, needs to be in wide format with one observation per subject</p></dd>

  <dt id="arg-clustervar">clustervar<a class="anchor" aria-label="anchor" href="#arg-clustervar"></a></dt>
<dd><p>optional, cluster variable name in dataset, character string</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>significance level alpha used for confidence intervals, the default is 0.05.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is an implementation of the algorithm described in the appendix of Gu and Pepe (2009) using the GEE approach in order to get standard error estimates. The definition of I and Zero matrices is slightly more flexible than the ones described in section 3 in order to allow for models without interaction.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list including</p>
<dl><dt>logPreTestModel</dt>
<dd><p>logistic regression model output for prior disease using base model X: P(D=1|X). All estimates are on a log scale.</p></dd>

<dt>logPostTestModel</dt>
<dd><p>logistic regression model output for posterior disease using augmented model V: P(D=1|X,Y),i.e. P(D=1|V). All estimates are on a log scale.</p></dd>

<dt>logDLRModel</dt>
<dd><p>regression model output for log DLR defined as difference between logPostTestModel and logPreTestModel. All estimates are on a log scale.</p></dd>

<dt>DLR</dt>
<dd><p>Positive/negative DLR for diagnostic marker Y, with all base covariates X set to 1. Results are only sensible for binary marker Y taking values 0/1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gu, W. and Pepe, M. S. (2009). Estimating the capacity for improvement in risk prediction with a marker. <em>Biostatistics</em>, 10(1):172-86.</p>
<p><!-- %Janssens, A. C. J. W., Deng, Y., Borsboom, G. J. J. M., Eijkemans, M. J. C., Habbema, J. D. F., and Steyerberg, E. W. (2005). A new logistic regression approach for the evaluation of diagnostic test results. \emph{Med Decis Making}, 25(2):168-77. --></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Hielscher (t.hielscher@dkfz.de)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="dlr.regtest.html">dlr.regtest</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chstock/DTComPair" class="external-link">DTComPair</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Paired1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test y1 conditioned on null model: DLR+(Y1=1) and DLR-(Y1=0)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">DLR</span><span class="op">(</span><span class="st">"~ 1"</span>,<span class="st">"~ y1"</span>,<span class="st">"d"</span>,<span class="va">Paired1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> running glm to get initial regression estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.intercept v.intercept        v.y1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.5469469  -1.1871657   2.7402852 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logPreTestModel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Naive S.E.  Naive z Robust S.E. Robust z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.intercept 0.5469469 0.07785552 7.025153  0.07777347 7.032564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logPostTestModel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Naive S.E.   Naive z Robust S.E.  Robust z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> v.intercept -1.187166  0.1556254 -7.628355   0.1554614 -7.636403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> v.y1         2.740285  0.1966554 13.934448   0.1964482 13.949150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logDLRModel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               coefs  robustSE     Zstat       pvalue   lowerCI   upperCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept -1.734113 0.1346088 -12.88261 5.639448e-38 -1.997941 -1.470284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1         2.740285 0.1964482  13.94915 3.183780e-44  2.355254  3.125317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    DLR   lowerCI   upperCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DLR(Y=1|X=1) 2.7351124 2.2860079 3.2724472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DLR(Y=0|X=1) 0.1765568 0.1356142 0.2298601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test y1 conditioned on test y2 with interaction, DLR+(Y1=1|Y2=1) and DLR-(Y1=0|Y2=1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">DLR</span><span class="op">(</span><span class="st">"~ y2"</span>,<span class="st">"~ y2 * y1"</span>,<span class="st">"d"</span>,<span class="va">Paired1</span><span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> running glm to get initial regression estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.intercept        x.y2 v.intercept        v.y2        v.y1     v.y2.y1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.6370577   2.4986483  -1.5776892   1.5776892   1.9641061   0.3670976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logPreTestModel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Naive S.E.   Naive z Robust S.E.  Robust z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.intercept -0.6370577  0.1181415 -5.392329   0.1178923 -5.403725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.y2         2.4986483  0.1893413 13.196530   0.1889420 13.224420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logPostTestModel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Naive S.E.    Naive z Robust S.E.   Robust z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> v.intercept -1.5776892  0.1945794 -8.1082030   0.1941690 -8.1253390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> v.y2         1.5776892  0.3593813  4.3900152   0.3586233  4.3992931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> v.y1         1.9641061  0.2639766  7.4404546   0.2634199  7.4561794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> v.y2.y1      0.3670978  0.4433058  0.8280915   0.4423709  0.8298416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logDLRModel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                coefs  robustSE      Zstat       pvalue    lowerCI    upperCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept -0.9406315 0.1542822 -6.0968227 1.081974e-09 -1.2430191 -0.6382439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2        -0.9209591 0.3048141 -3.0213796 2.516257e-03 -1.5183837 -0.3235344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1         1.9641061 0.2634199  7.4561794 8.906744e-14  1.4478126  2.4803997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2.y1      0.3670978 0.4423709  0.8298416 4.066283e-01 -0.4999332  1.2341288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    DLR    lowerCI   upperCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DLR(Y=1|X=1) 1.5993757 1.27265876 2.0099673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DLR(Y=0|X=1) 0.1554252 0.09284387 0.2601895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christian Stock, Thomas Hielscher, Andrea Discacciati.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

